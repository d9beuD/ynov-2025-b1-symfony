{% extends 'base.html.twig' %}

{% block title %}{{ post.title }}{% endblock %}

{% block body %}
    <div class="container my-5">
        <div class="row">
            <div class="col">
                <twig:Post post="{{ post }}">
                    {{ component('Post:Header', { post: post }) }}
                    <twig:Post:Content post="{{ post }}" />
                    <twig:Post:Actions post="{{ post }}" />
                </twig:Post>

                {# Comment form #}
                {{ form_start(form) }}
                    <h2 class="h4">Commenter</h2>
                    {{ form_errors(form) }}
                    {{ form_row(form.content, {label: false, attr: { rows: 4, style: 'resize: none;' } }) }}
                    <div class="text-end">
                        <button type="submit" class="btn btn-primary rounded-pill">
                            <i class="fa-solid fa-arrow-right"></i>
                            Commenter
                        </button>
                    </div>
                    {{ form_widget(form.post, { value: post.id }) }}
                {{ form_end(form) }}

                {# Existing comments #}
                <ul class="list-unstyled">
                    {% for comment in post.comments %}
                        <li>
                            <twig:Comment comment="{{ comment }}" />
                        </li>
                    {% endfor %}
                </ul>
            </div>

            {# Aside #}
            <div class="col-sm-4 col-md-3">
                <div class="bg-body-tertiary p-3 rounded-3 mb-3 border position-relative">
                    <h2 class="h5">{{ post.topic.title }}</h2>
                    <p class="mb-0">{{ post.topic.description }}</p>
                    <a class="stretched-link" href="{{ path('app_topic_show', { id: post.topic.id }) }}"></a>
                </div>

                <div class="d-flex flex-column gap-1">
                    <a class="btn btn-primary d-block text-start" href="{{ path('app_post_edit', {'id': post.id}) }}">
                        <i class="fa-solid fa-fw fa-edit"></i>
                        Modifier la publication
                    </a>
                    {{ include('post/_delete_form.html.twig') }}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
